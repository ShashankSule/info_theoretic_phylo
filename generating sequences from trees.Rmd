---
title: "Computing sequences from trees"
output:
  github_document:
    pandoc_args: --webtex
---

```{r setup, include=FALSE}
library("adegenet")
library("ape")
library("apTreeshape")
library("BoSSA")
library("diversitree")
library("pegas")
library("phangorn")
library("phylobase")
#library("phyloch")
library("seqinr")
source("utilities.R")
library("ggplot2")
library("phyclust")
library("TreeDist")
library("TreeTools")
```

# Generating sequences via `phyclust` and `seqgen` 

```{r}
set.seed(123)
ret.ms <- ms(nsam = 5, nreps = 1, opts = "-T")
tree.anc <- read.tree(text = ret.ms[3])
set.seed(123)
seqgen(opts = "-mHKY -l40 -q", newick.tree = ret.ms[3])
```


# Read via `evolver` in `PAML`

```{r}
trees <- list()
sequences <- list()

for(i in 1:10){
  hit_dat()
  system("paml4.8/src/evolverRandomTree 5 paml4.8/MCbaseRTree.dat") 
  trees[[i]] <- write.tree(read.nexus("mctrees.nex"))
  sequences[[i]] <- ReadCharacters("mc.nex")
}
```

We generated an `mc.nex` file using the parameter `2` in the MC. Let's read it, get the original tree and see what tree we've got via upgma on the sequence. 

```{r}
```


```{r}
agg_clustering(sequence)
```

```{r}
# diagnostics: 


```

